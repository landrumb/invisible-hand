{% extends "base.html" %}
{% block title %}{{ game.name }} Â· Invisible Hand Arcade{% endblock %}
{% block content %}
<section class="panel game trivia">
  <h1>{{ game.name }}</h1>
  <p>{{ game.description }}</p>
  {% if set_description %}
    <p class="game-details">{{ set_description }}</p>
  {% endif %}

  <form method="post" class="game-form">
    <input type="hidden" name="token" value="{{ token }}">
    <fieldset>
      <legend>{{ question.prompt }}</legend>
      {% if question.image %}
        <figure class="trivia-figure">
          <img src="{{ question.image }}" alt="Question illustration">
        </figure>
      {% endif %}
      {% for choice in question.choices %}
        <label class="choice">
          <input type="radio" name="answer" value="{{ loop.index0 }}" required>
          <span>{{ choice }}</span>
        </label>
      {% endfor %}
    </fieldset>
    <button type="submit" class="button primary">Lock in answer</button>
  </form>

  {% if result %}
    <div class="game-result {{ result.category }}">
      <strong>{{ result.title }}</strong>
      <p>{{ result.message }}</p>
    </div>
    {% if result.rate %}
      <div class="trivia-feedback">
        <p>How was this question?</p>
        <div class="feedback-actions">
          <form method="post" action="{{ url_for('main.rate_trivia_question', game_key=game.key) }}">
            <input type="hidden" name="token" value="{{ result.rate.token }}">
            <input type="hidden" name="action" value="good">
            <button type="submit" class="button secondary">Good question</button>
          </form>
          <form method="post" action="{{ url_for('main.rate_trivia_question', game_key=game.key) }}">
            <input type="hidden" name="token" value="{{ result.rate.token }}">
            <input type="hidden" name="action" value="bad">
            <button type="submit" class="button secondary">Bad question</button>
          </form>
          <form method="post" action="{{ url_for('main.rate_trivia_question', game_key=game.key) }}">
            <input type="hidden" name="token" value="{{ result.rate.token }}">
            <input type="hidden" name="action" value="report">
            <button type="submit" class="button warning">Report question</button>
          </form>
        </div>
      </div>
    {% endif %}
  {% endif %}
  <div class="trivia-footer">
    <a class="button secondary" href="{{ submit_question_url }}">Submit a trivia question</a>
  </div>
</section>
{% endblock %}
