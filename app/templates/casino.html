{% extends "base.html" %}
{% block title %}Casino · Invisible Hand Arcade{% endblock %}
{% block content %}
<section class="panel wide">
  <h1>Casino Technologies Trading Floor</h1>
  <p>
    Spin up earnings for <strong>CT</strong> with neon slots and instant blackjack hands.
    Dividends are published every twenty minutes based on the house ledger.
  </p>
  <div class="casino-status">
    <div>
      <span class="label">Pending profit</span>
      <span class="value">{{ status.pending_profit|round(2) }}</span>
    </div>
    <div>
      <span class="label">Last publish</span>
      <span class="value">{{ status.last_publish_at or "–" }}</span>
    </div>
    <div>
      <span class="label">Next publish</span>
      <span class="value">{{ status.next_publish_at or "–" }}</span>
    </div>
    {% if status.last_summary %}
    <div class="wide">
      <span class="label">Last action</span>
      <span class="value">{{ status.last_summary }}</span>
    </div>
    {% endif %}
  </div>
</section>

<section class="panel wide">
  <h2>Slots Lobby</h2>
  <div class="casino-grid">
    {% for slot in slots %}
      <div class="casino-machine">
        <h3>{{ slot.name }}</h3>
        <p class="theme">{{ slot.theme }}</p>
        <p class="payout">Configured payout rate: {{ '%.2f'|format(slot.payout_rate) }}</p>
        <form method="post" action="{{ url_for('main.play_slot') }}" class="casino-form">
          <input type="hidden" name="slot_id" value="{{ slot.key }}">
          <label>
            Wager
            <input type="number" name="wager" min="0.01" step="0.01" value="5.00" required>
          </label>
          <button type="submit" class="primary">Spin</button>
        </form>
      </div>
    {% endfor %}
  </div>
</section>

<section class="panel wide">
  <h2>Quick Blackjack</h2>
  <p>
    Hands resolve automatically with classic rules: players stand on 17, dealers hit on soft 16, and
    naturals pay {{ '%.2f'|format(manager.blackjack_payout) }}×.
  </p>
  <form method="post" action="{{ url_for('main.play_blackjack') }}" class="casino-form blackjack">
    <label>
      Wager ({{ manager.blackjack_min_bet|round(2) }} – {{ manager.blackjack_max_bet|round(2) }})
      <input type="number" name="wager" step="0.01" min="{{ manager.blackjack_min_bet }}" max="{{ manager.blackjack_max_bet }}" value="{{ manager.blackjack_min_bet }}" required>
    </label>
    <button type="submit" class="primary">Deal</button>
  </form>
</section>
{% endblock %}
